# 浏览器的存储有哪些？（了解）

**题目**: 浏览器的存储有哪些？（了解）

**答案**:

浏览器提供了多种存储机制，适用于不同的使用场景：

## 1. Cookie
- **大小限制**: 每个域名下通常限制在4KB以内
- **生命周期**: 可以设置过期时间，支持会话级和持久存储
- **作用域**: 可以设置domain和path，支持跨子域
- **传输**: 每次HTTP请求都会携带，增加请求体积
- **用途**: 主要用于身份验证、会话管理

```javascript
// 设置Cookie
document.cookie = "username=John; expires=Thu, 18 Dec 2024 12:00:00 UTC; path=/";

// 读取Cookie
console.log(document.cookie);
```

## 2. localStorage
- **大小限制**: 通常为5-10MB（不同浏览器不同）
- **生命周期**: 持久存储，除非手动清除，否则永久保存
- **作用域**: 同源策略（协议+域名+端口）
- **传输**: 不参与HTTP请求
- **用途**: 存储大量本地数据，如用户偏好设置

```javascript
// 存储数据
localStorage.setItem('key', 'value');
localStorage.setItem('user', JSON.stringify({name: 'John', age: 25}));

// 读取数据
const value = localStorage.getItem('key');
const user = JSON.parse(localStorage.getItem('user'));

// 删除数据
localStorage.removeItem('key');
localStorage.clear(); // 清空所有数据
```

## 3. sessionStorage
- **大小限制**: 通常为5-10MB
- **生命周期**: 仅在当前会话期间有效，关闭标签页或浏览器后清除
- **作用域**: 同源策略，但仅限于当前标签页
- **传输**: 不参与HTTP请求
- **用途**: 临时数据存储，如表单数据缓存

```javascript
// 使用方式与localStorage相同
sessionStorage.setItem('tempData', 'temporary value');
const temp = sessionStorage.getItem('tempData');
```

## 4. IndexedDB
- **大小限制**: 理论上无限制（受磁盘空间限制），通常很大
- **数据类型**: 支持存储对象、数组等复杂数据结构
- **事务性**: 支持事务操作，保证数据一致性
- **异步**: 所有操作都是异步的，不会阻塞主线程
- **用途**: 存储大量结构化数据，支持索引查询

```javascript
// 打开数据库
const request = indexedDB.open('MyDatabase', 1);

request.onupgradeneeded = function(event) {
  const db = event.target.result;
  // 创建对象仓库
  const objectStore = db.createObjectStore('users', { keyPath: 'id' });
  // 创建索引
  objectStore.createIndex('name', 'name', { unique: false });
};

request.onsuccess = function(event) {
  const db = event.target.result;
  const transaction = db.transaction(['users'], 'readwrite');
  const objectStore = transaction.objectStore('users');
  
  // 添加数据
  objectStore.add({ id: 1, name: 'John', email: 'john@example.com' });
};
```

## 5. Web SQL（已废弃）
- **注意**: 已被废弃，不推荐使用
- 曾经提供SQL风格的客户端数据库存储

## 6. Cache API
- **用途**: 用于缓存HTTP请求和响应
- **场景**: Service Worker配合，实现离线功能
- **标准**: 现代PWA应用的重要组成部分

```javascript
// 缓存资源
caches.open('v1').then(function(cache) {
  return cache.addAll([
    '/css/style.css',
    '/js/app.js',
    '/'
  ]);
});
```

## 7. File System Access API
- **新特性**: 更现代的文件系统访问API
- **能力**: 读写本地文件系统（需要用户授权）
- **场景**: 需要直接操作文件的应用

## 各存储方式对比

| 存储方式 | 容量 | 持久性 | 同步/异步 | 适用场景 |
|---------|------|--------|-----------|----------|
| Cookie | 4KB | 可设置 | 同步 | 会话管理、身份验证 |
| localStorage | 5-10MB | 持久 | 同步 | 用户偏好、本地数据 |
| sessionStorage | 5-10MB | 会话级 | 同步 | 临时数据、表单缓存 |
| IndexedDB | 无限制 | 持久 | 异步 | 大量结构化数据 |
| Cache API | 无限制 | 可设置 | 异步 | 离线缓存、PWA |

## 安全考虑
- 所有存储都遵循同源策略
- Cookie可以设置HttpOnly标志防止XSS
- Cookie可以设置Secure标志确保HTTPS传输
- 敏感数据应加密存储
- 注意清理过期数据防止信息泄露

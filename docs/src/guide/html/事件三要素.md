# 事件三要素（必会）

**题目**: 事件三要素（必会）

**答案**:

JavaScript 事件的三要素是指构成事件机制的三个基本组成部分：

## 1. 事件源 (Event Source)

事件源是触发事件的元素或对象，也称为事件目标 (Event Target)。

### 定义
- 发生事件的 DOM 元素或 JavaScript 对象
- 用户交互的目标对象

### 常见事件源
```javascript
// HTML 元素作为事件源
const button = document.getElementById('myButton');
const input = document.querySelector('input');
const div = document.querySelector('.container');

// window 对象作为事件源
window.addEventListener('load', function() {
    console.log('页面加载完成');
});

// document 对象作为事件源
document.addEventListener('DOMContentLoaded', function() {
    console.log('DOM 内容加载完成');
});
```

### 获取事件源
```javascript
element.addEventListener('click', function(event) {
    console.log(event.target);       // 实际触发事件的元素
    console.log(event.currentTarget); // 绑定事件监听器的元素
});
```

## 2. 事件类型 (Event Type)

事件类型定义了发生的事件种类，是一个字符串标识符。

### 常见鼠标事件
```javascript
// 点击事件
element.addEventListener('click', handler);
element.addEventListener('dblclick', handler);  // 双击
element.addEventListener('mousedown', handler); // 鼠标按下
element.addEventListener('mouseup', handler);   // 鼠标抬起
element.addEventListener('mouseover', handler); // 鼠标悬停
element.addEventListener('mouseout', handler);  // 鼠标离开
element.addEventListener('mousemove', handler); // 鼠标移动
```

### 常见键盘事件
```javascript
// 键盘事件
input.addEventListener('keydown', handler); // 按键按下
input.addEventListener('keyup', handler);   // 按键释放
input.addEventListener('keypress', handler); // 按键按下并产生字符
```

### 常见表单事件
```javascript
// 表单事件
input.addEventListener('focus', handler);    // 获得焦点
input.addEventListener('blur', handler);     // 失去焦点
input.addEventListener('change', handler);   // 值改变并失去焦点
input.addEventListener('input', handler);    // 输入时触发
form.addEventListener('submit', handler);    // 表单提交
```

### 常见文档/窗口事件
```javascript
// 文档和窗口事件
window.addEventListener('load', handler);        // 页面完全加载
window.addEventListener('resize', handler);      // 窗口大小改变
window.addEventListener('scroll', handler);      // 滚动
document.addEventListener('DOMContentLoaded', handler); // DOM 加载完成
```

## 3. 事件处理程序 (Event Handler)

事件处理程序是响应事件发生时要执行的函数。

### 事件处理程序的定义方式

#### 3.1 内联事件处理程序
```html
<!-- HTML 中定义 -->
<button onclick="alert('Hello')">点击我</button>
<input onfocus="this.style.backgroundColor='yellow'" onblur="this.style.backgroundColor=''">
```

#### 3.2 DOM0 级事件处理程序
```javascript
const button = document.getElementById('myButton');

// 直接赋值函数
button.onclick = function() {
    console.log('按钮被点击了');
};

// 使用函数名
function clickHandler() {
    console.log('按钮被点击了');
}
button.onclick = clickHandler;

// 移除事件处理程序
button.onclick = null;
```

#### 3.3 DOM2 级事件处理程序 (推荐)
```javascript
const button = document.getElementById('myButton');

// 使用 addEventListener
button.addEventListener('click', function() {
    console.log('按钮被点击了');
});

// 使用命名函数
function clickHandler() {
    console.log('按钮被点击了');
}
button.addEventListener('click', clickHandler);

// 移除事件监听器
button.removeEventListener('click', clickHandler);
```

### 事件处理程序中的 this 指向

```javascript
const button = document.getElementById('myButton');

// 在事件处理程序中，this 指向事件目标
button.addEventListener('click', function() {
    console.log(this === button); // true
});

// 箭头函数中，this 继承外层作用域
button.addEventListener('click', () => {
    console.log(this); // 指向外层作用域的 this
});
```

### 事件对象 (Event Object)

事件处理程序会接收一个事件对象参数：

```javascript
element.addEventListener('click', function(event) {
    // 事件对象的常用属性和方法
    console.log(event.type);           // 事件类型
    console.log(event.target);         // 事件目标
    console.log(event.currentTarget);  // 当前处理事件的元素
    console.log(event.clientX);        // 鼠标 X 坐标
    console.log(event.clientY);        // 鼠标 Y 坐标
    
    // 事件对象的方法
    event.preventDefault();            // 阻止默认行为
    event.stopPropagation();           // 阻止事件冒泡
});
```

## 事件三要素的完整示例

```javascript
// 1. 事件源
const button = document.getElementById('submitBtn');

// 2. 事件类型 - 'click'
// 3. 事件处理程序
button.addEventListener('click', function(event) {
    console.log('按钮被点击了');
    console.log('事件类型:', event.type);
    console.log('事件目标:', event.target);
    
    // 阻止表单默认提交行为
    event.preventDefault();
});
```

## 实际应用场景

### 表单验证
```javascript
const form = document.getElementById('myForm');
const emailInput = document.getElementById('email');

// 事件源：emailInput
// 事件类型：blur（失去焦点）
// 事件处理程序：验证邮箱格式
emailInput.addEventListener('blur', function() {
    const email = this.value;
    const isValid = /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
    
    if (!isValid) {
        this.style.borderColor = 'red';
    } else {
        this.style.borderColor = 'green';
    }
});
```

### 动态内容交互
```javascript
// 事件委托：利用事件冒泡
document.getElementById('list').addEventListener('click', function(event) {
    // 事件源：可能是列表项，也可能是容器
    // 事件类型：click
    // 事件处理程序：检查点击的是否是列表项
    if (event.target.tagName === 'LI') {
        event.target.classList.toggle('selected');
    }
});
```

## 总结

事件三要素是 JavaScript 事件机制的核心概念：

1. **事件源** - 谁触发了事件 (What triggered the event)
2. **事件类型** - 发生了什么事件 (What type of event occurred)
3. **事件处理程序** - 如何响应事件 (How to respond to the event)

理解这三个要素对于掌握 JavaScript 事件处理机制至关重要，它们共同构成了用户交互的基础。

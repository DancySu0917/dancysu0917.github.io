# 路由之间是怎么跳转的？有哪些方式？（必会）

## 标准答案

Vue Router路由跳转主要有两种方式：声明式导航和编程式导航。声明式导航使用`<router-link>`组件；编程式导航使用`$router.push()`、`$router.replace()`、`$router.go()`等方法。

## 深入理解

Vue Router提供了多种路由跳转方式，主要分为声明式导航和编程式导航两大类：

### 1. 声明式导航

使用`<router-link>`组件进行路由跳转，这是最常用的方式：

```vue
<template>
  <div>
    <!-- 基本用法 -->
    <router-link to="/">首页</router-link>
    <router-link to="/about">关于</router-link>
    
    <!-- 使用命名路由 -->
    <router-link :to="{ name: 'User', params: { id: 123 }}">用户</router-link>
    
    <!-- 带查询参数 -->
    <router-link :to="{ path: '/search', query: { q: 'vue' }}">搜索</router-link>
    
    <!-- 带哈希 -->
    <router-link :to="{ path: '/page', hash: '#section' }">页面锚点</router-link>
    
    <!-- 替换当前历史记录 -->
    <router-link :to="/about" replace>替换当前路由</router-link>
    
    <!-- 自定义标签 -->
    <router-link to="/admin" tag="li">管理</router-link>
    
    <!-- 激活状态类名 -->
    <router-link to="/home" active-class="active-link">首页</router-link>
    <router-link to="/about" exact-active-class="exact-active">关于</router-link>
  </div>
</template>
```

### 2. 编程式导航

通过JavaScript代码进行路由跳转，提供更大的灵活性：

#### 2.1 push() 方法 - 添加新记录

```javascript
export default {
  methods: {
    // 字符串路径
    goToHome() {
      this.$router.push('/')
    },
    
    // 对象形式
    goToUser(userId) {
      this.$router.push({ path: '/user/' + userId })
      // 或使用命名路由
      this.$router.push({ name: 'User', params: { id: userId }})
    },
    
    // 带查询参数
    search(keyword) {
      this.$router.push({ path: '/search', query: { q: keyword }})
    },
    
    // 带哈希
    goToSection() {
      this.$router.push({ path: '/page', hash: '#section' })
    },
    
    // 使用完整路径
    goToComplete() {
      this.$router.push({ path: '/user/123?tab=profile#section' })
    }
  }
}
```

#### 2.2 replace() 方法 - 替换当前记录

```javascript
export default {
  methods: {
    // 不会在浏览器历史中留下记录
    replaceToLogin() {
      this.$router.replace('/login')
    },
    
    // 使用对象形式
    replaceWithParams() {
      this.$router.replace({ 
        name: 'User', 
        params: { id: 123 },
        query: { redirect: 'dashboard' }
      })
    }
  }
}
```

#### 2.3 go() 方法 - 在历史记录中前进或后退

```javascript
export default {
  methods: {
    // 后退一页
    goBack() {
      this.$router.go(-1)
    },
    
    // 前进一页
    goForward() {
      this.$router.go(1)
    },
    
    // 前进3页
    goForwardThree() {
      this.$router.go(3)
    },
    
    // 如果没有足够的历史记录，不会有任何效果
    goBackTwo() {
      this.$router.go(-2)
    }
  }
}
```

### 3. Composition API中的编程式导航

```vue
<template>
  <div>
    <button @click="goToHome">首页</button>
    <button @click="goToUser">用户</button>
  </div>
</template>

<script>
import { useRouter } from 'vue-router'

export default {
  setup() {
    const router = useRouter()
    
    const goToHome = () => {
      router.push('/')
    }
    
    const goToUser = (userId) => {
      router.push({ name: 'User', params: { id: userId }})
    }
    
    const goBack = () => {
      router.go(-1)
    }
    
    return {
      goToHome,
      goToUser,
      goBack
    }
  }
}
</script>
```

### 4. 路由跳转的参数传递

```javascript
// 传递参数的几种方式
// 1. 路径参数
this.$router.push('/user/123')

// 2. 命名路由 + 参数
this.$router.push({ name: 'User', params: { id: 123 }})

// 3. 查询参数
this.$router.push({ path: '/search', query: { q: 'vue', page: 1 }})

// 4. 组合使用
this.$router.push({ 
  name: 'User', 
  params: { id: 123 }, 
  query: { tab: 'profile' },
  hash: '#top'
})
```

### 5. 路由跳转的异步处理

```javascript
export default {
  methods: {
    async navigateToUser(userId) {
      try {
        // push方法返回Promise，可以等待导航完成
        const result = await this.$router.push({ name: 'User', params: { id: userId }})
        console.log('导航成功', result)
      } catch (error) {
        if (error.name === 'NavigationDuplicated') {
          // 处理重复导航错误
          console.log('重复导航')
        } else {
          console.error('导航失败', error)
        }
      }
    },
    
    // 替换路由的异步处理
    async replaceToLogin() {
      try {
        await this.$router.replace('/login')
        console.log('路由替换成功')
      } catch (error) {
        console.error('路由替换失败', error)
      }
    }
  }
}
```

### 6. 路由跳转的高级用法

```javascript
export default {
  methods: {
    // 带滚动行为的导航
    navigateWithScroll(toPath) {
      this.$router.push({
        path: toPath,
        // 跳转后滚动到顶部
        beforeEnter: (to, from, next) => {
          window.scrollTo(0, 0)
          next()
        }
      })
    },
    
    // 条件导航
    conditionalNavigate(userId) {
      if (this.isAuthenticated) {
        this.$router.push({ name: 'User', params: { id: userId }})
      } else {
        this.$router.push({ name: 'Login', query: { redirect: this.$route.path }})
      }
    }
  }
}
```

### 7. 路由跳转方式对比

| 方式 | 优点 | 缺点 | 适用场景 |
|------|------|------|----------|
| `<router-link>` | 语义化好，支持SEO，自动处理激活状态 | 灵活性较低 | 静态导航链接 |
| `push()` | 灵活性高，可动态控制 | 需要编写更多代码 | 条件导航、动态路由 |
| `replace()` | 不产生历史记录 | 无法后退到原页面 | 登录后替换、错误页面 |
| `go()` | 简单的前进后退 | 仅限于历史记录操作 | 返回上一页等场景 |

通过以上方式，可以根据不同需求选择合适的路由跳转方法，实现灵活的页面导航功能。

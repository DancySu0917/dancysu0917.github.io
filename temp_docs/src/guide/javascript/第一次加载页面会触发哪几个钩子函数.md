# 第一次加载页面会触发哪几个钩子函数？

## 标准答案

第一次加载页面时，Vue 组件会经历创建阶段和挂载阶段，会依次触发以下生命周期钩子函数：

1. **beforeCreate** - 实例初始化之后，数据观测和事件配置之前
2. **created** - 实例创建完成，数据观测、属性和方法的运算已完成
3. **beforeMount** - 挂载开始之前被调用
4. **mounted** - 实例挂载到DOM后调用

这四个钩子函数是组件首次渲染时一定会执行的，它们按顺序执行，构成了组件从创建到挂载到DOM的完整流程。

## 深入理解

当 Vue 组件第一次加载页面时，会经历完整的创建和挂载过程。每个钩子函数都有其特定的执行时机和用途：

### Vue 2 首次加载生命周期示例

```javascript
// Vue 2 首次加载页面的生命周期演示
new Vue({
    el: '#app',
    template: `
        <div>
            <h1>{{ title }}</h1>
            <p>{{ message }}</p>
        </div>
    `,
    
    data() {
        return {
            title: 'Vue 应用',
            message: '欢迎使用 Vue'
        };
    },
    
    beforeCreate() {
        console.log('1. beforeCreate: 实例刚创建');
        console.log('   - data:', this.title); // undefined
        console.log('   - methods:', typeof this.someMethod); // undefined
        // 此时数据观测和事件配置尚未开始
    },
    
    created() {
        console.log('2. created: 实例已创建');
        console.log('   - data:', this.title); // 'Vue 应用'
        console.log('   - methods:', typeof this.someMethod); // 'function'
        // 数据观测已完成，但DOM还未挂载
        // 适合进行数据初始化、API请求等
    },
    
    beforeMount() {
        console.log('3. beforeMount: 挂载前');
        console.log('   - $el:', this.$el); // 存在但内容是未编译的模板
        // 模板编译完成，但尚未挂载到真实DOM
    },
    
    mounted() {
        console.log('4. mounted: 组件已挂载');
        console.log('   - $el:', this.$el); // 已挂载到真实DOM
        console.log('   - DOM:', this.$el.innerHTML); // 已渲染的HTML内容
        // 此时可以访问真实的DOM元素
        // 适合进行DOM操作、发起初始数据请求、设置定时器等
    },
    
    methods: {
        someMethod() {
            console.log('这是一个方法');
        }
    }
});

// 输出顺序：
// 1. beforeCreate: 实例刚创建
// 2. created: 实例已创建  
// 3. beforeMount: 挂载前
// 4. mounted: 组件已挂载
```

### Vue 3 首次加载生命周期示例

```javascript
// Vue 3 Composition API 首次加载示例
import { createApp, ref, onBeforeMount, onMounted, onBeforeCreate, onCreated } from 'vue';

const app = createApp({
    setup() {
        const title = ref('Vue 3 应用');
        const message = ref('欢迎使用 Vue 3');
        
        // 在 setup 中相当于 beforeCreate 和 created
        console.log('setup: 组合式API初始化');
        
        onBeforeMount(() => {
            console.log('onBeforeMount: 挂载前');
        });
        
        onMounted(() => {
            console.log('onMounted: 组件已挂载');
            // 访问DOM元素
            console.log('DOM元素:', document.querySelector('h1'));
        });
        
        return {
            title,
            message
        };
    },
    
    template: `
        <div>
            <h1>{{ title }}</h1>
            <p>{{ message }}</p>
        </div>
    `
});

app.mount('#app');

// Vue 3 Options API 方式
const app2 = createApp({
    data() {
        return {
            title: 'Vue 3 应用',
            message: '欢迎使用 Vue 3'
        };
    },
    
    created() {
        console.log('created: 实例已创建');
    },
    
    beforeMount() {
        console.log('beforeMount: 挂载前');
    },
    
    mounted() {
        console.log('mounted: 组件已挂载');
    },
    
    template: `
        <div>
            <h1>{{ title }}</h1>
            <p>{{ message }}</p>
        </div>
    `
});
```

### 实际应用场景

```javascript
// 实际开发中首次加载的典型应用
export default {
    name: 'UserList',
    
    data() {
        return {
            users: [],
            loading: true,
            error: null
        };
    },
    
    async beforeCreate() {
        // 极少在此阶段添加逻辑
        console.log('组件实例即将创建');
    },
    
    async created() {
        // 数据初始化和API请求
        console.log('组件已创建，开始加载数据');
        try {
            // 在 created 阶段发起数据请求
            // 此时还未挂载DOM，但可以处理数据逻辑
            const response = await fetch('/api/users');
            this.users = await response.json();
        } catch (err) {
            this.error = err.message;
        } finally {
            this.loading = false;
        }
    },
    
    beforeMount() {
        // 挂载前的最后准备
        console.log('即将挂载到DOM');
        // 一般不在此阶段添加复杂逻辑
    },
    
    mounted() {
        // DOM挂载完成，可以进行DOM操作
        console.log('组件已挂载，可以访问DOM元素');
        
        // 初始化第三方库
        this.initChart();
        
        // 设置定时器
        this.timer = setInterval(() => {
            console.log('定时任务执行');
        }, 5000);
        
        // 添加事件监听器
        window.addEventListener('resize', this.handleResize);
    },
    
    beforeDestroy() {
        // 清理工作
        if (this.timer) {
            clearInterval(this.timer);
        }
        window.removeEventListener('resize', this.handleResize);
    },
    
    methods: {
        initChart() {
            // 初始化图表等需要DOM的操作
            console.log('初始化图表');
        },
        
        handleResize() {
            // 处理窗口大小变化
            console.log('窗口大小变化');
        }
    }
};
```

### 生命周期执行时序图

```
创建阶段:
beforeCreate  →  created

挂载阶段:  
beforeMount   →  mounted

首次加载执行顺序: beforeCreate → created → beforeMount → mounted
```

### 注意事项

1. **数据访问**: 在 `beforeCreate` 和 `created` 中无法访问DOM元素，但可以访问数据和方法
2. **DOM操作**: 只能在 `mounted` 及其后的钩子中进行DOM操作
3. **性能考虑**: 在 `created` 阶段进行数据请求可以尽早开始加载数据
4. **异步操作**: 在 `created` 阶段发起的异步操作，可能在 `mounted` 之后才完成

理解首次加载的生命周期对于正确初始化组件、处理数据请求和DOM操作至关重要。
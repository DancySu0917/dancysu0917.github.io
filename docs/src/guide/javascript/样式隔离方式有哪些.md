# 样式隔离方式有哪些？（了解）

**题目**: 样式隔离方式有哪些？（了解）

**答案**:

样式隔离是前端开发中避免样式冲突和污染的重要技术，主要有以下几种方式：

## 1. CSS Modules
将 CSS 类名转换为局部作用域，避免全局污染：
```css
/* styles.module.css */
.container {
  padding: 20px;
  background: #f0f0f0;
}

.title {
  color: #333;
}
```

```javascript
// Component.js
import styles from './styles.module.css';

function Component() {
  return (
    <div className={styles.container}>
      <h1 className={styles.title}>标题</h1>
    </div>
  );
}
// 最终生成类似 container__container___abc123 的唯一类名
```

## 2. CSS-in-JS
通过 JavaScript 动态生成样式，实现作用域隔离：
```javascript
import styled from 'styled-components';

const Container = styled.div`
  padding: 20px;
  background: #f0f0f0;
`;

const Title = styled.h1`
  color: #333;
`;

function Component() {
  return (
    <Container>
      <Title>标题</Title>
    </Container>
  );
}
```

## 3. Shadow DOM
提供真正的封装，样式不会泄漏到外部，外部样式也不会影响内部：
```javascript
class MyComponent extends HTMLElement {
  constructor() {
    super();
    const shadow = this.attachShadow({mode: 'open'});
    
    shadow.innerHTML = `
      <style>
        /* 这些样式只在shadow dom内生效 */
        .container {
          padding: 20px;
          background: #f0f0f0;
        }
        
        .title {
          color: #333;
        }
      </style>
      <div class="container">
        <h1 class="title">标题</h1>
      </div>
    `;
  }
}

customElements.define('my-component', MyComponent);
```

## 4. 命名空间和 BEM 规范
通过约定的命名方式避免冲突：
```css
/* 命名空间方式 */
.myapp-container { }
.myapp-header { }
.myapp-sidebar { }

/* BEM (Block Element Modifier) 方式 */
.card { }
.card__header { }
.card__body { }
.card--featured { }
```

## 5. CSS 自定义属性 (CSS Variables)
通过变量实现主题化和局部样式控制：
```css
.component {
  --primary-color: #007bff;
  --font-size: 16px;
  
  color: var(--primary-color);
  font-size: var(--font-size);
}
```

## 6. CSS Scope 属性
在构建时为样式添加唯一属性选择器：
```html
<!-- 编译前 -->
<div class="container">
  <h1 class="title">标题</h1>
</div>

<style scoped>
.container { padding: 20px; }
.title { color: #333; }
</style>

<!-- 编译后 -->
<div class="container" data-v-123abc>
  <h1 class="title" data-v-123abc>标题</h1>
</div>

<style>
.container[data-v-123abc] { padding: 20px; }
.title[data-v-123abc] { color: #333; }
</style>
```

## 7. Iframe 隔离
完全隔离的样式环境，但存在通信复杂、SEO 不友好等问题：
```html
<iframe src="component.html" style="border: none;"></iframe>
```

## 8. PostCSS 插件
使用插件自动添加前缀或作用域：
- postcss-prefixwrap: 自动为选择器添加前缀
- postcss-modules: 实现 CSS 模块化
- postcss-scopify: 为 CSS 添加作用域

## 9. Web Components
结合 Shadow DOM 和自定义元素实现完整的组件封装：
```javascript
class CustomCard extends HTMLElement {
  constructor() {
    super();
    
    // 创建 Shadow DOM
    const shadow = this.shadowRoot || this.attachShadow({mode: 'closed'});
    
    shadow.innerHTML = `
      <style>
        :host {
          display: block;
          border: 1px solid #ccc;
          border-radius: 4px;
        }
        
        .header {
          padding: 10px;
          background: #f5f5f5;
          border-bottom: 1px solid #ddd;
        }
        
        .content {
          padding: 10px;
        }
      </style>
      <div class="header">
        <slot name="header"></slot>
      </div>
      <div class="content">
        <slot></slot>
      </div>
    `;
  }
}

customElements.define('custom-card', CustomCard);
```

每种方式都有其适用场景，需要根据项目需求、团队技术栈和性能要求来选择合适的样式隔离方案。
